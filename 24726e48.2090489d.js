(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{123:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/files/a-10-dp-776f25738e2a9d2b4416f757c244d780.pdf"},124:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/output_16_0-9037bd83b314944e482a19bb94d12226.png"},125:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/output_18_0-db3e88900d5ac0a096d851d342c452f5.png"},63:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return s})),a.d(t,"metadata",(function(){return o})),a.d(t,"rightToc",(function(){return l})),a.d(t,"default",(function(){return d}));var n=a(2),r=a(6),i=(a(0),a(88)),s={title:"Data Preprocessing"},o={unversionedId:"sec-a/a-10-dp",id:"sec-a/a-10-dp",isDocsHomePage:!1,title:"Data Preprocessing",description:"Authors: Patricia Schutter, Katherine Zingerman, Jenny Robinson. (PDF)",source:"@site/docs\\sec-a\\a-10-dp.md",slug:"/sec-a/a-10-dp",permalink:"/APM-2020/docs/sec-a/a-10-dp",version:"current",lastUpdatedAt:1603328123,sidebar:"docs",previous:{title:"Multi-Layered Perceptron",permalink:"/APM-2020/docs/sec-a/a-09-mlp"},next:{title:"Handling Outliers",permalink:"/APM-2020/docs/sec-a/a-11-outliers"}},l=[{value:"Potential Issues with Data",id:"potential-issues-with-data",children:[]},{value:"Step 1: Dealing with Missing Values (imputation)",id:"step-1-dealing-with-missing-values-imputation",children:[]},{value:"Step 2: Outliers",id:"step-2-outliers",children:[]},{value:"Additional Resources",id:"additional-resources",children:[]}],c={rightToc:l};function d(e){var t=e.components,s=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},c,s,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Authors: Patricia Schutter, Katherine Zingerman, Jenny Robinson. (",Object(i.b)("a",{target:"_blank",href:a(123).default},"PDF"),")"),Object(i.b)("p",null,"In this lecture, we reviewed the importance of preprocessing data. We all know that retrieving and working with data can come with many issues, and it's impossible to get reliable results without cleaning and analyzing our data before we get to work. "),Object(i.b)("h2",{id:"potential-issues-with-data"},"Potential Issues with Data"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"1. Quantity")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Do we have enough data to get a reliable result? The amount of data needed depends on the nature of the problem. ")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"2. Quality and Adequacy")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Do the current data form and data features answer the questions we are asking?")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"3. Labels")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"How is the data organized, and is it consistent?")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"4. Big Data")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"How can we find the signal in all the noise? How can we keep track of large volumes of fast data collection?")),Object(i.b)("h1",{id:"why-preprocess-data"},"Why Preprocess Data?"),Object(i.b)("p",null,"The main idea behind preprocessing data is to ensure speed and accuracy of our results. We only want to use the data that is needed for the questions asked, and we want to reduce/eliminate all possible errors that could stem from inconsistency, incompleteness, noise, or duplicate data. These issues are inevitable because data collection is not perfect. Perhaps the data has null values or default values that aren't thoughtful. The data is likely to come from a variety of sources in different formats, and it always contains some degree of noise. By preprocessing our data, we can greatly reduce the effects of these issues and enhance the accuracy of our predictions or insights. "),Object(i.b)("h1",{id:"preprocessing-steps"},"Preprocessing Steps:"),Object(i.b)("p",null,"To preprocess the data efficiently, it's helpful to go through each step below to ensure we handle all aspects of the data. These steps are not always linear, and repeating steps is not uncommon! If you aren't spending at least 75% of your time on this part, you may not be paying enough attention to preprocessing."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"1. Data Cleaning")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Basic data cleaning is absolutely necessary no matter how small or large the task. Without cleaning the data, you will almost always encounter errors (whether they occur in the code or the results). Some data might look very clean and standardized, especially if it comes from a warehouse, but you should still do sanity checks and look for consistency. ")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"2. Exploratory Data Analysis")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"I'm sure most (or all) of us have experienced an obnoxious python error that will not go away no matter how you change your code, only to find out that there's a null row or an \"int\" value where there should be a string. Maybe you've run a linear regression that gave you a huge error because you ignored a single outlier. These mistakes are made from skipping this step! Save yourself a lot of time and make sure to explore your data before moving forward with the task.")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"3. Data Reduction")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Redundant data or overload of data not only slows down analytical processes, but it can also interfere with proper analysis. For instance, if there are too many features in our model, overfitting can occur which will lead to larger errors. ")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"4. Data Visualization")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"This is one of the most overlooked steps in data preprocessing! It can be tempting to jump right into the analysis, but if you don't have a solid understanding of the data you're dealing with, you will waste time fixing errors that could've been avoided. ")),Object(i.b)("h1",{id:"preview-data"},"Preview Data"),Object(i.b)("p",null,"Prior to cleaning the data, it is important to take the time to get an overview of the data that you will be cleaning, to better understand how the data is in its current state and what should be done to improve the quality of the data. There are a few key performances that one should do to get a better feel for the data. These procedures include: getting summary statistics, getting a count of missing values, understanding the datatypes associated with the data, and seeing the data through a visualization tool such as a boxplot or scatterplot."),Object(i.b)("h1",{id:"pre-processing-in-scikit-learn"},"Pre-processing in Scikit-learn"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"#import basic necessary modules \nimport pandas as pd    \nimport numpy as np \nfrom sklearn.datasets import load_iris\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nimport matplotlib.pyplot as plt\n\n#import iris standard dataset \niris = load_iris()\n\n#transform scikit learn dataset to pandas dataframe and set columns & rows\niris = pd.DataFrame(iris.data, columns=iris.feature_names)\n\n#create train and test sets \ny = iris.iloc[:, 0]\nX = iris.iloc[:, 1:]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state = 50)\n\n# #create a scaler on the training data \n# #calculates mean and st.dev on training set to reapply the same transformation on the testing set\nscaler = StandardScaler().fit(X_train)\nscaler.mean_ #calculates mean\nscaler.scale_ #determine scale of data \n\n# #use scaler to transform new data in same way as X_train\nX_test_transformed = scaler.transform(X_test)\n\n# #scaling features to the range [0,1]\nmin_max_scaler = MinMaxScaler()\nX_train_minmax = min_max_scaler.fit_transform(X_train)\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"#create a scaler on the training data \n#calculates mean and st.dev on training set to reapply the same transformation on the testing set\nscaler = StandardScaler().fit(X_train)\nscaler.mean_ #calculates mean\nscaler.scale_ #determine scale of data \n\n#use scaler to transform new data in same way as X_train\nX_test_transformed = scaler.transform(X_test)\n\n#scaling features to the range [0,1]\nmin_max_scaler = MinMaxScaler()\nX_train_minmax = min_max_scaler.fit_transform(X_train)\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"from sklearn.preprocessing import scale\n\n#fit data to a Gaussian distribution \nX_scaled = scale(X_train) \n\n#set the mean = 0\nX_scaled.mean(axis=0)\n\n#set st.dev = 1\nX_scaled.std(axis=0)\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"array([1., 1., 1.])\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"from sklearn.preprocessing import OrdinalEncoder\n#encoding categorical features to numerical features\nencode = OrdinalEncoder()\nZ = [['male', 'from US', 'uses Safari'], ['female', 'from Europe', 'uses Firefox']]\n\n#base categorical variables on given dataset \nZ = encode.fit(Z)\nencode.transform([['female', 'from US', 'uses Safari']])\n")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"array([[0., 1., 1.]])\n")),Object(i.b)("h1",{id:"scatter-plot-visualization"},"Scatter plot visualization"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# create visualization where you can see the distribution of data and understand how independent and dependent\n# variables interact with each other. Scatter plots are used for a variety of predictive modeling techniques to see\n# how data behaves so it is very important to understand the relationships in the data. \n\nimport pandas as pd    \nimport numpy as np \nfrom sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split\nimport matplotlib.pyplot as plt\n\n#import iris standard dataset \niris = load_iris()\n\n#transform scikit learn dataset to pandas dataframe and set columns & rows\niris = pd.DataFrame(iris.data, columns=iris.feature_names)\n\n#create x and y to plot \ny1 = iris['sepal length (cm)']\nX1 = iris['sepal width (cm)']\n\ny2 = iris['petal length (cm)']\nX2 = iris['petal width (cm)']\n\n#create scatter plot \nplt.figure(figsize=(20,10)) #set figure space\nplt.scatter(X1, y1, c = 'lawngreen', marker = 'o', label = 'Sepal width v length')\nplt.scatter(X2, y2, c='violet', marker='o', label='Petal width v length')\nplt.legend(loc='upper left')\nplt.show()\n")),Object(i.b)("p",null,Object(i.b)("img",{alt:"png",src:a(124).default})),Object(i.b)("h1",{id:"box-plot-visualization"},"Box plot visualization"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-python"}),"# create box plots to see the distribution of the data and understand the maximum, minimum, median, averages, outliers, \n# ranges of the multiple datasets in a single figure plane. These are very important to create when initially looking \n# at data to understand basic features of the data. It also shows the different quartile breakdown of the data and \n# shows the 25th, 50th, and 75th quartiles. \n\n# Creating random dataset \nnp.random.seed(10) \n  \ndata_1 = np.random.normal(100, 10, 200) \ndata_2 = np.random.normal(90, 20, 200) \ndata_3 = np.random.normal(80, 30, 200) \ndata_4 = np.random.normal(70, 40, 200) \ndata = [data_1, data_2, data_3, data_4] \n  \nfig = plt.figure(figsize =(10, 7)) \n  \nax = fig.add_subplot(111) \n  \n# Creating axes instance \nbp = ax.boxplot(data, patch_artist = True, \n                notch ='True', vert = 0) \n  \ncolors = ['#0000FF', '#00FF00',  \n          '#FFFF00', '#FF00FF'] \n  \nfor patch, color in zip(bp['boxes'], colors): \n    patch.set_facecolor(color) \n\n# changing color and linewidth of whiskers \nfor whisker in bp['whiskers']: \n    whisker.set(color ='#8B008B', linewidth = 1.5, linestyle =\":\") \n    \n# changing color and linewidth of \n# caps \nfor cap in bp['caps']: \n    cap.set(color ='#8B008B', linewidth = 2) \n    \n# changing color and linewidth of \n# medians \nfor median in bp['medians']: \n    median.set(color ='black', linewidth = 3) \n    \n# changing style of fliers \nfor flier in bp['fliers']: \n    flier.set(marker ='D', color ='#e7298a', alpha = 0.5) \n      \n# x-axis labels \nax.set_yticklabels(['data_1', 'data_2','data_3', 'data_4']) \n  \n# Adding title  \nplt.title(\"Distribution of data\") \n  \n# Removing top axes and right axes \n# ticks \nax.get_xaxis().tick_bottom() \nax.get_yaxis().tick_left() \n      \n# show plot \nplt.show(bp) \n")),Object(i.b)("p",null,Object(i.b)("img",{alt:"png",src:a(125).default})),Object(i.b)("h1",{id:"data-cleaning"},"Data Cleaning"),Object(i.b)("p",null,"Data is often given with missing values such as in the table below."),Object(i.b)("p",null,Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://i.imgur.com/AHHh4I6.png"}),Object(i.b)("img",Object(n.a)({parentName:"a"},{src:"https://i.imgur.com/AHHh4I6.png",alt:null})))),Object(i.b)("h2",{id:"step-1-dealing-with-missing-values-imputation"},"Step 1: Dealing with Missing Values (imputation)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"1. Understand why the data is missing")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Missing at random (MAR)- missingness is random within subgroups"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Example: From the table above, it may look like the income variable was missed among many people, but if we dive deeper into the role of these people, it is missing for all senior level roles. (While it is missing for an entry level role as well, it missing entirely for all senior roles.) "))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Missing completely at random (MCAR)- These values are missing completely due to randomness.            "),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Example: There is no data for line 9. This could be because the survey was lost. Therefore, these values are missing completely at random."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Missing not at random (MNAR)- These values tend to be missing because of the value themselves.            "),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Example: In line 8, the entry level education person did not share their income, perhaps because it was a low value.   ")))),Object(i.b)("p",null,"Data that is classified as missing at random creates an element of intuition that must be thought through:"),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Why is this data missing for this particular category? ")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Does this missing data tell us something?")),Object(i.b)("b",null,"2. What to do about missing values"),"- Ignore rows with missing data - Replace by mean, median, or constant for all missing values - Use the mean or median from the rows with similar conditions for each missing value - Turn the row into a binary response: whether the question was answered or not",Object(i.b)("h2",{id:"step-2-outliers"},"Step 2: Outliers"),Object(i.b)("p",null,Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://i.imgur.com/C9vVrPg.png"}),Object(i.b)("img",Object(n.a)({parentName:"a"},{src:"https://i.imgur.com/C9vVrPg.png",alt:null})))),Object(i.b)("p",null,"Outliers are data objects that lie outside of the majority of the other data points. It is important to detect outliers in data as they can destory the quality of the data you are working with. When working with data, it is important to understand the type of problem to know whether your data is based on outliers (fraud) or not."),Object(i.b)("b",null,"Some strategies for dealing with outliers include:"),"- Dectecting them and tossing them out - Changing the value of outliers to make them less extreme",Object(i.b)("h2",{id:"additional-resources"},"Additional Resources"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.youtube.com/watch?v=P_iMSYQnqac"}),"Missing Values"))))}d.isMDXComponent=!0},88:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=r.a.createContext({}),d=function(e){var t=r.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=d(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=d(a),b=n,m=p["".concat(s,".").concat(b)]||p[b]||u[b]||i;return a?r.a.createElement(m,o(o({ref:t},c),{},{components:a})):r.a.createElement(m,o({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,s=new Array(i);s[0]=b;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:n,s[1]=o;for(var c=2;c<i;c++)s[c]=a[c];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,a)}b.displayName="MDXCreateElement"}}]);